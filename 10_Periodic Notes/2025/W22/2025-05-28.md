---
created: 2025-05-28
tags:
  - type/timeline/daily
---
# 📅 2025-05-28 Wednesday

  
## ✅ Tasks

- [ ] 

## 📌 Notes

- 

## 💡 TIL

#### 1. 디펜던시에 여러 React 버전이 물려있으면 ReactCurrentOwner 오류가 뜬다..
→ `npm ls react`  로 디펜던시 트리를 통해 어디서 충돌나는지 확인 후 조치

#### 2. Spring boot 버전업 후 부트 시 다음 오류 발생
`org.springframework.context.ApplicationContextException: Component scan for configuration class[~~~~] could not be used with conditions in REGISTER_BEAN phase`  
→ bean registration lifecycle의 강화된 조건 처리 시스템에서 발생하는 오류다.
 `@Conditional` 조건이 Bean 등록 단계(*REGISTER_BEAN*)에서 사용할 수 없는 설정이나 위치에 걸려 있을 때 발생한다.
	
📌 핵심 원인
 1. `@ComponentScan` 대상 클래스에 `@Conditional`이 걸려 있고,
	예시
```java
	@Configuration
	@ComponentScan(basePackages = "com.example.feature")
	public class MyAppConfig {}	
```
	그리고
```java
	@Conditional(OnSomethingCondition.class)  // ← 이게 문제
	@Component
	public class SomeClass {}
```
	→ 이 경우 Spring은 ComponentScan으로 클래스를 찾고 빈으로 등록하려 하지만,
	REGISTER_BEAN 단계에서 조건 평가가 불가능해서 에러 발생
	  

✅ 해결 방법
1. @Conditional을 피하고 @Bean 메서드에 조건 부여
```java
	@Configuration
	public class FeatureConfig {
	
		@Bean
		@Conditional(OnSomethingCondition.class)
		public SomeClass someClass() {
			return new SomeClass();
		}
	}
```

2. @Conditional 대신 @ConditionalOnProperty, @Profile, @ConditionalOnClass 같은 Spring Boot 전용 어노테이션 사용
```java
@Component
@ConditionalOnProperty(name = "feature.x.enabled", havingValue = "true")
public class SomeClass {}
```

#### 보충: REGISTER_BEAN Phase란?
Spring의 bean 등록 단계 중 하나로,
bean definition → bean registration → bean instantiation → bean wiring 순서 중 중간 단계.
@ComponentScan은 REGISTER_BEAN phase에서 @Conditional이 걸린 클래스를 처리할 수 없음.
→ 조건은 bean method 수준 또는 @Import된 클래스에만 적용 가능



### 📎 Links